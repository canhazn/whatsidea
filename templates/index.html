{% extends 'base.html' %}
{%load static %}

<!-- Extra head here -->
{% block extrahead %}
<title>whatsIdea</title>
<meta name="content" content="">
{% endblock extrahead %}



<!-- Content here -->
{% block content %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.8.4/moment.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-rss/3.3.0/jquery.rss.min.js"></script>
<style>
    .new-idea-btn {
        cursor: pointer;
    }

    img {
        width: 120px;
    }

    #side-nav {
        position: relative;
    }

    .rss-area {
        position: sticky;
        top: 72px;
        right: 0;
    }

    #rss-feeds {
        overflow: auto;
        max-height: calc(100vh - 118px);
    }
</style>
<div>
    <div class="row">
        <div class="col-md-7 p-0 p-md-3">
            <main>
                <div class="search-area mb-3 mx-3 mx-md-0">
                    <legend>
                        Search for Business Ideas!</legend>
                    <form action="GET">
                        <div class="form-group">
                            <div class="input-group mb-2 mr-sm-2">
                                <div class="input-group-prepend">
                                    <div class="input-group-text">
                                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-search"
                                            fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd"
                                                d="M10.442 10.442a1 1 0 0 1 1.415 0l3.85 3.85a1 1 0 0 1-1.414 1.415l-3.85-3.85a1 1 0 0 1 0-1.415z" />
                                            <path fill-rule="evenodd"
                                                d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11zM13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0z" />
                                        </svg>
                                    </div>
                                </div>
                                <input type="text" class="form-control" id="inlineFormInputGroupUsername2"
                                    placeholder="Search">
                            </div>
                            <small id="emailHelp" class="form-text text-muted">We've been shared {{ idea_count }} ideas
                            </small>
                        </div>
                    </form>
                </div>
                <div class="">
                    {% include "component/idea-create.html" %}
                </div>

                <div>
                    {% for idea in ideas %}
                    <div id="{{ idea.slug }}" class="idea px-1 px-md-3 py-2 my-3 bg-white rounded"
                        data-idea_slug="{{ idea.slug }}">
                        <h2 class="h4 my-2">
                            <a href="{% url 'idea-detail-page' idea.slug %}"> {{ idea.title }} </a>
                        </h2>
                        {% if idea.shortdesc %}
                        <p class="p-3 border-left-success">{{ idea.shortdesc }}</p>
                        {% endif %}

                        {% comment %} {% if idea.shortdesc %}
                        <div class="p-3 my-3 border border-left-success">
                        </div>
                        {% endif %}
                        {% endcomment %}
                        <div class="editorjs p-3 my-3 border border-left-secondary" id="editorjs-{{ idea.slug }}"
                            data-content="{{ idea.content }}" data-editor_id="editorjs-{{ idea.slug }}">
                        </div>

                        <div class="mt-3">
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="vote">
                                    <div class="d-inline-block mr-3">
                                        <a class="navbar-brand mr-1 cursor-pointer btn-idea-vote"
                                            data-idea_id="{{ idea.id }}">
                                            {% include "component/vote-icon.html"%}
                                        </a>
                                        <span>{{ idea.vote_set.all.count }} </span>
                                    </div>
                                    <div class="d-inline-block">
                                        <a class="navbar-brand mr-0" href="">
                                            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-puzzle-fill"
                                                fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                <path fill-rule="evenodd"
                                                    d="M3.112 3.645A1.5 1.5 0 0 1 4.605 2H7a.5.5 0 0 1 .5.5v.382c0 .696-.497 1.182-.872 1.469a.459.459 0 0 0-.115.118.113.113 0 0 0-.012.025L6.5 4.5v.003l.003.01c.004.01.014.028.036.053a.86.86 0 0 0 .27.194C7.09 4.9 7.51 5 8 5c.492 0 .912-.1 1.19-.24a.86.86 0 0 0 .271-.194.213.213 0 0 0 .036-.054l.003-.01v-.008a.112.112 0 0 0-.012-.025.459.459 0 0 0-.115-.118c-.375-.287-.872-.773-.872-1.469V2.5A.5.5 0 0 1 9 2h2.395a1.5 1.5 0 0 1 1.493 1.645L12.645 6.5h.237c.195 0 .42-.147.675-.48.21-.274.528-.52.943-.52.568 0 .947.447 1.154.862C15.877 6.807 16 7.387 16 8s-.123 1.193-.346 1.638c-.207.415-.586.862-1.154.862-.415 0-.733-.246-.943-.52-.255-.333-.48-.48-.675-.48h-.237l.243 2.855A1.5 1.5 0 0 1 11.395 14H9a.5.5 0 0 1-.5-.5v-.382c0-.696.497-1.182.872-1.469a.459.459 0 0 0 .115-.118.113.113 0 0 0 .012-.025L9.5 11.5v-.003l-.003-.01a.214.214 0 0 0-.036-.053.859.859 0 0 0-.27-.194C8.91 11.1 8.49 11 8 11c-.491 0-.912.1-1.19.24a.859.859 0 0 0-.271.194.214.214 0 0 0-.036.054l-.003.01v.002l.001.006a.113.113 0 0 0 .012.025c.016.027.05.068.115.118.375.287.872.773.872 1.469v.382a.5.5 0 0 1-.5.5H4.605a1.5 1.5 0 0 1-1.493-1.645L3.356 9.5h-.238c-.195 0-.42.147-.675.48-.21.274-.528.52-.943.52-.568 0-.947-.447-1.154-.862C.123 9.193 0 8.613 0 8s.123-1.193.346-1.638C.553 5.947.932 5.5 1.5 5.5c.415 0 .733.246.943.52.255.333.48.48.675.48h.238l-.244-2.855z" />
                                            </svg>
                                        </a>
                                        <span>{{ idea.contribution_set.all.count }} </span>
                                    </div>
                                </div>
                                <a class="idea-slug" href="{% url 'idea-detail-page' idea.slug %}">
                                    @{{ idea.slug }}
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}

                </div>

            </main>
        </div>

        <div class="col-md-5 p-0 p-md-3" id="side-nav">
            <div class="rss-area bg-white">
                <legend class="border-bottom px-3 pt-3 pb-2">Starup news:</legend>
                <div id="rss-feeds"></div>
            </div>
        </div>
    </div>
</div>

<script>
    $(".editorjs").each(function () {
        let current = $(this);
        console.log(current.data("content"))
        let editor = new EditorJS({
            readOnly: true,
            holder: current.data("editor_id"),
            minHeight: '0',
            data: current.data("content"),
            tools: editor_tools
        });
    });

    $("#rss-feeds").rss("https://vnexpress.net/rss/startup.rss", {
        limit: 10,
        ssl: true,
        layoutTemplate: "<ul class='list-group p-0'>{entries}</ul>",
        entryTemplate: `<li class="list-group-item border-left-0 border-top-0 border-bottom">
                            <a href="{url}" class="w-100">
                                <img class="w-100 rounded" src="{teaserImageUrl}" alt="" srcset="">
                            </a>    
                            <div class="pt-3">
                            <a href="{url}" class="mt-2">{title}</a>
                            </div>                        
                            {shortBodyPlain}
                            <small class="d-block">{date}</small>                            
                          </li>`,
        dateFormat: "D/MM, YYYY",


    });
</script>

{% endblock content %}